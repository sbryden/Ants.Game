import{P as h}from"./phaser-0RJB29YE.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();var r=(i=>(i.IDLE="IDLE",i.WANDERING="WANDERING",i.FORAGING="FORAGING",i.RETURNING="RETURNING",i))(r||{});class g{constructor(t,e,n,s){this.id=t,this.x=e,this.y=n,this.vx=0,this.vy=0,this.targetVx=0,this.targetVy=0,this.state=r.IDLE,this.colonyId=s,this.timeSinceDirectionChange=0,this.timeInCurrentState=0}}class f{constructor(t,e,n){this.id=t,this.x=e,this.y=n,this.ants=[],this.resourceCount=0}spawnAnt(t){const e=new g(t,this.x,this.y,this.id);return this.ants.push(e),e}getAnts(){return[...this.ants]}getAntCount(){return this.ants.length}}class y{constructor(t,e){this.width=t,this.height=e,this.colonies=[],this.nextAntId=0,this.cachedAnts=[],this.antsCacheDirty=!0}createColony(t,e){const n=this.colonies.length,s=new f(n,t,e);return this.colonies.push(s),s}spawnAnt(t){const e=t.spawnAnt(this.nextAntId++);return this.antsCacheDirty=!0,e}getAllAnts(){if(this.antsCacheDirty){this.cachedAnts=[];for(const t of this.colonies)this.cachedAnts.push(...t.getAnts());this.antsCacheDirty=!1}return this.cachedAnts}getColonies(){return[...this.colonies]}getColony(t){return this.colonies[t]}}function c(i,t){const e=Math.random()*Math.PI*2;i.targetVx=Math.cos(e)*t.speed,i.targetVy=Math.sin(e)*t.speed}function p(i,t,e,n){const s=t-i.x,o=e-i.y,a=Math.sqrt(s*s+o*o);a>0&&(i.targetVx=s/a*n.speed,i.targetVy=o/a*n.speed)}function C(i,t,e,n=10){const s=t-i.x,o=e-i.y;return s*s+o*o<n*n}function I(i,t,e){const n=Math.min(1,t.turnSpeed*e*10);i.vx+=(i.targetVx-i.vx)*n,i.vy+=(i.targetVy-i.vy)*n}function R(i,t){i.x+=i.vx*t,i.y+=i.vy*t}function m(i,t){(i.x<0||i.x>t.width)&&(i.vx*=-1,i.x=Math.max(0,Math.min(t.width,i.x))),(i.y<0||i.y>t.height)&&(i.vy*=-1,i.y=Math.max(0,Math.min(t.height,i.y)))}const l={idleToWanderingChance:.5,wanderingMinDuration:3,wanderingToForagingChance:.1,wanderingToReturningChance:.05,foragingMinDuration:5,foragingToReturningChance:.1};function N(i,t,e=l){const n=i.state,s=i.timeInCurrentState;switch(n){case r.IDLE:if(Math.random()<e.idleToWanderingChance*t)return r.WANDERING;break;case r.WANDERING:if(s>=e.wanderingMinDuration){if(Math.random()<e.wanderingToForagingChance*t)return r.FORAGING;if(Math.random()<e.wanderingToReturningChance*t)return r.RETURNING}break;case r.FORAGING:if(s>=e.foragingMinDuration&&Math.random()<e.foragingToReturningChance*t)return r.RETURNING;break;case r.RETURNING:break}return n}function d(i,t){i.state!==t&&(i.state=t,i.timeInCurrentState=0)}const x={INITIAL_ANT_COUNT:20};class A{constructor(t){this.world=t,this.movementConfig={speed:50,changeDirectionInterval:2,turnSpeed:.3},this.transitionConfig=l}tick(t){const e=this.world.getAllAnts();for(const n of e)this.updateAntBehavior(n,t)}updateAntBehavior(t,e){t.timeSinceDirectionChange+=e,t.timeInCurrentState+=e;const n=this.world.getColony(t.colonyId);if(!n)return;const s=N(t,e,this.transitionConfig);switch(s!==t.state&&d(t,s),t.state){case r.IDLE:t.targetVx=0,t.targetVy=0;break;case r.WANDERING:t.timeSinceDirectionChange>=this.movementConfig.changeDirectionInterval&&(c(t,this.movementConfig),t.timeSinceDirectionChange=0);break;case r.FORAGING:t.timeSinceDirectionChange>=this.movementConfig.changeDirectionInterval&&(c(t,this.movementConfig),t.timeSinceDirectionChange=0);break;case r.RETURNING:p(t,n.x,n.y,this.movementConfig),C(t,n.x,n.y,15)&&d(t,r.IDLE);break}I(t,this.movementConfig,e),R(t,e),m(t,this.world)}update(t){this.tick(t)}initializeWorld(){const t=this.world.createColony(this.world.width/2,this.world.height/2);for(let e=0;e<x.INITIAL_ANT_COUNT;e++){const n=this.world.spawnAnt(t);c(n,this.movementConfig)}}}class w{constructor(t){this.antBodyRadius=3,this.antHeadRadius=2,this.antHeadColor=6636321,this.stateColors={[r.IDLE]:8421504,[r.WANDERING]:9127187,[r.FORAGING]:4881486,[r.RETURNING]:4286881},this.graphics=t.add.graphics()}render(t){this.graphics.clear();for(const e of t)this.drawAnt(e)}drawAnt(t){const e=Math.sqrt(t.vx*t.vx+t.vy*t.vy);let n=0,s=0;if(e>0){const a=t.vx/e,u=t.vy/e;n=a*(this.antBodyRadius+this.antHeadRadius),s=u*(this.antBodyRadius+this.antHeadRadius)}const o=this.stateColors[t.state]||9127187;this.graphics.fillStyle(o,1),this.graphics.fillCircle(t.x,t.y,this.antBodyRadius),this.graphics.fillStyle(this.antHeadColor,1),this.graphics.fillCircle(t.x+n,t.y+s,this.antHeadRadius)}destroy(){this.graphics.destroy()}}class D{constructor(t){this.nestRadius=20,this.nestColor=7356948,this.nestBorderColor=9127187,this.nestBorderWidth=2,this.graphics=t.add.graphics()}render(t){this.graphics.clear();for(const e of t)this.drawColony(e)}drawColony(t){this.graphics.fillStyle(this.nestColor,.6),this.graphics.fillCircle(t.x,t.y,this.nestRadius),this.graphics.lineStyle(this.nestBorderWidth,this.nestBorderColor,1),this.graphics.strokeCircle(t.x,t.y,this.nestRadius),this.graphics.fillStyle(0,.3),this.graphics.fillCircle(t.x,t.y,this.nestRadius*.4)}destroy(){this.graphics.destroy()}}class G extends h.Scene{constructor(){super({key:"MainScene"})}create(){this.cameras.main.setBackgroundColor("#2d4a2e");const t=this.scale.width,e=this.scale.height;this.world=new y(t,e),this.simulationSystem=new A(this.world),this.simulationSystem.initializeWorld(),this.antRenderer=new w(this),this.colonyRenderer=new D(this),this.add.text(16,16,"Ants!",{fontSize:"32px",color:"#ffffff",fontStyle:"bold"}).setDepth(100),this.add.text(16,56,"Watch the ants wander and return home...",{fontSize:"16px",color:"#cccccc"}).setDepth(100),this.add.text(16,84,"Colors: Gray=Idle, Brown=Wandering, Green=Foraging, Blue=Returning",{fontSize:"12px",color:"#aaaaaa"}).setDepth(100),this.debugText=this.add.text(16,this.scale.height-40,"",{fontSize:"14px",color:"#ffffff",backgroundColor:"#00000088",padding:{x:8,y:4}}).setDepth(100)}update(t,e){const n=e/1e3;this.simulationSystem.update(n),this.colonyRenderer.render(this.world.getColonies());const s=this.world.getAllAnts();this.antRenderer.render(s),this.updateDebugUI(s)}updateDebugUI(t){const e={[r.IDLE]:0,[r.WANDERING]:0,[r.FORAGING]:0,[r.RETURNING]:0};for(const s of t)e[s.state]++;const n=[`Total: ${t.length}`,`Idle: ${e[r.IDLE]}`,`Wandering: ${e[r.WANDERING]}`,`Foraging: ${e[r.FORAGING]}`,`Returning: ${e[r.RETURNING]}`].join(" | ");this.debugText.setText(n)}shutdown(){this.antRenderer.destroy(),this.colonyRenderer.destroy()}}const S={type:h.AUTO,width:1024,height:768,parent:"game-container",backgroundColor:"#2d4a2e",scene:[G],scale:{mode:h.Scale.FIT,autoCenter:h.Scale.CENTER_BOTH}};new h.Game(S);
