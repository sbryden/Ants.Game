import{P as E}from"./phaser-0RJB29YE.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function e(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(s){if(s.ep)return;s.ep=!0;const c=e(s);fetch(s.href,c)}})();var o=(i=>(i.IDLE="IDLE",i.WANDERING="WANDERING",i.FORAGING="FORAGING",i.RETURNING="RETURNING",i))(o||{});class A{constructor(t,e,n,s){this.id=t,this.x=e,this.y=n,this.vx=0,this.vy=0,this.targetVx=0,this.targetVy=0,this.state=o.IDLE,this.colonyId=s,this.timeSinceDirectionChange=0,this.timeInCurrentState=0}}class D{constructor(t,e,n){this.id=t,this.x=e,this.y=n,this.ants=[],this.resourceCount=0}spawnAnt(t){const e=new A(t,this.x,this.y,this.id);return this.ants.push(e),e}getAnts(){return[...this.ants]}getAntCount(){return this.ants.length}}class _{constructor(t,e){this.width=t,this.height=e,this.colonies=[],this.nextAntId=0,this.cachedAnts=[],this.antsCacheDirty=!0}createColony(t,e){const n=this.colonies.length,s=new D(n,t,e);return this.colonies.push(s),s}spawnAnt(t){const e=t.spawnAnt(this.nextAntId++);return this.antsCacheDirty=!0,e}getAllAnts(){if(this.antsCacheDirty){this.cachedAnts=[];for(const t of this.colonies)this.cachedAnts.push(...t.getAnts());this.antsCacheDirty=!1}return this.cachedAnts}getColonies(){return[...this.colonies]}getColony(t){return this.colonies[t]}}function O(i,t){const e=Math.random()*Math.PI*2;i.targetVx=Math.cos(e)*t.speed,i.targetVy=Math.sin(e)*t.speed}function g(i,t,e,n){const s=t-i.x,c=e-i.y,h=Math.sqrt(s*s+c*c);h>0&&(i.targetVx=s/h*n.speed,i.targetVy=c/h*n.speed)}function u(i,t,e,n=10){const s=t-i.x,c=e-i.y;return s*s+c*c<n*n}function f(i,t,e){const n=Math.min(1,t.turnSpeed*e*10);i.vx+=(i.targetVx-i.vx)*n,i.vy+=(i.targetVy-i.vy)*n}function S(i,t){i.x+=i.vx*t,i.y+=i.vy*t}function G(i,t){(i.x<0||i.x>t.width)&&(i.vx*=-1,i.x=Math.max(0,Math.min(t.width,i.x))),(i.y<0||i.y>t.height)&&(i.vy*=-1,i.y=Math.max(0,Math.min(t.height,i.y)))}const R={CANVAS_WIDTH:1024,CANVAS_HEIGHT:768,BACKGROUND_COLOR:"#2d4a2e"},y={INITIAL_ANT_COUNT:20},d={SPEED:50,CHANGE_DIRECTION_INTERVAL:2,TURN_SPEED:.3},I={IDLE_TO_WANDERING_CHANCE:.5,WANDERING_MIN_DURATION:3,WANDERING_TO_FORAGING_CHANCE:.1,WANDERING_TO_RETURNING_CHANCE:.05,FORAGING_MIN_DURATION:5,FORAGING_TO_RETURNING_CHANCE:.1},p={HOME_ARRIVAL_DISTANCE:15},N={BODY_RADIUS:3,HEAD_RADIUS:2,HEAD_COLOR:6636321,STATE_COLORS:{IDLE:8421504,WANDERING:9127187,FORAGING:4881486,RETURNING:4286881},DEFAULT_BODY_COLOR:9127187},a={NEST_RADIUS:20,NEST_COLOR:7356948,NEST_BORDER_COLOR:9127187,NEST_BORDER_WIDTH:2,NEST_OPACITY:.6,ENTRANCE_RADIUS_MULTIPLIER:.4,ENTRANCE_COLOR:0,ENTRANCE_OPACITY:.3},r={TITLE:{X:16,Y:16,FONT_SIZE:"32px",COLOR:"#ffffff",TEXT:"Ants!"},INSTRUCTIONS:{X:16,Y:56,FONT_SIZE:"16px",COLOR:"#cccccc",TEXT:"Watch the ants wander and return home..."},LEGEND:{X:16,Y:84,FONT_SIZE:"12px",COLOR:"#aaaaaa",TEXT:"Colors: Gray=Idle, Brown=Wandering, Green=Foraging, Blue=Returning"},DEBUG:{X:16,Y_OFFSET_FROM_BOTTOM:40,FONT_SIZE:"14px",COLOR:"#ffffff",BACKGROUND_COLOR:"#00000088",PADDING:{x:8,y:4}},UI_DEPTH:100},C={idleToWanderingChance:I.IDLE_TO_WANDERING_CHANCE,wanderingMinDuration:I.WANDERING_MIN_DURATION,wanderingToForagingChance:I.WANDERING_TO_FORAGING_CHANCE,wanderingToReturningChance:I.WANDERING_TO_RETURNING_CHANCE,foragingMinDuration:I.FORAGING_MIN_DURATION,foragingToReturningChance:I.FORAGING_TO_RETURNING_CHANCE};function L(i,t,e=C){const n=i.state,s=i.timeInCurrentState;switch(n){case o.IDLE:if(Math.random()<e.idleToWanderingChance*t)return o.WANDERING;break;case o.WANDERING:if(s>=e.wanderingMinDuration){if(Math.random()<e.wanderingToForagingChance*t)return o.FORAGING;if(Math.random()<e.wanderingToReturningChance*t)return o.RETURNING}break;case o.FORAGING:if(s>=e.foragingMinDuration&&Math.random()<e.foragingToReturningChance*t)return o.RETURNING;break;case o.RETURNING:break}return n}function T(i,t){i.state!==t&&(i.state=t,i.timeInCurrentState=0)}class U{constructor(t){this.world=t,this.movementConfig={speed:d.SPEED,changeDirectionInterval:d.CHANGE_DIRECTION_INTERVAL,turnSpeed:d.TURN_SPEED},this.transitionConfig=C}tick(t){const e=this.world.getAllAnts();for(const n of e)this.updateAntBehavior(n,t)}updateAntBehavior(t,e){t.timeSinceDirectionChange+=e,t.timeInCurrentState+=e;const n=this.world.getColony(t.colonyId);if(!n)return;const s=L(t,e,this.transitionConfig);switch(s!==t.state&&T(t,s),t.state){case o.IDLE:t.targetVx=0,t.targetVy=0;break;case o.WANDERING:t.timeSinceDirectionChange>=this.movementConfig.changeDirectionInterval&&(O(t,this.movementConfig),t.timeSinceDirectionChange=0);break;case o.FORAGING:t.timeSinceDirectionChange>=this.movementConfig.changeDirectionInterval&&(O(t,this.movementConfig),t.timeSinceDirectionChange=0);break;case o.RETURNING:g(t,n.x,n.y,this.movementConfig),u(t,n.x,n.y,p.HOME_ARRIVAL_DISTANCE)&&T(t,o.IDLE);break}f(t,this.movementConfig,e),S(t,e),G(t,this.world)}update(t){this.tick(t)}initializeWorld(){const t=this.world.createColony(this.world.width/2,this.world.height/2);for(let e=0;e<y.INITIAL_ANT_COUNT;e++){const n=this.world.spawnAnt(t);O(n,this.movementConfig)}}}class m{constructor(t){this.graphics=t.add.graphics()}render(t){this.graphics.clear();for(const e of t)this.drawAnt(e)}drawAnt(t){const e=Math.sqrt(t.vx*t.vx+t.vy*t.vy);let n=0,s=0;if(e>0){const h=t.vx/e,l=t.vy/e;n=h*(N.BODY_RADIUS+N.HEAD_RADIUS),s=l*(N.BODY_RADIUS+N.HEAD_RADIUS)}const c=N.STATE_COLORS[t.state]||N.DEFAULT_BODY_COLOR;this.graphics.fillStyle(c,1),this.graphics.fillCircle(t.x,t.y,N.BODY_RADIUS),this.graphics.fillStyle(N.HEAD_COLOR,1),this.graphics.fillCircle(t.x+n,t.y+s,N.HEAD_RADIUS)}destroy(){this.graphics.destroy()}}class x{constructor(t){this.graphics=t.add.graphics()}render(t){this.graphics.clear();for(const e of t)this.drawColony(e)}drawColony(t){this.graphics.fillStyle(a.NEST_COLOR,a.NEST_OPACITY),this.graphics.fillCircle(t.x,t.y,a.NEST_RADIUS),this.graphics.lineStyle(a.NEST_BORDER_WIDTH,a.NEST_BORDER_COLOR,1),this.graphics.strokeCircle(t.x,t.y,a.NEST_RADIUS),this.graphics.fillStyle(a.ENTRANCE_COLOR,a.ENTRANCE_OPACITY),this.graphics.fillCircle(t.x,t.y,a.NEST_RADIUS*a.ENTRANCE_RADIUS_MULTIPLIER)}destroy(){this.graphics.destroy()}}class F extends E.Scene{constructor(){super({key:"MainScene"})}create(){this.cameras.main.setBackgroundColor(R.BACKGROUND_COLOR);const t=this.scale.width,e=this.scale.height;this.world=new _(t,e),this.simulationSystem=new U(this.world),this.simulationSystem.initializeWorld(),this.antRenderer=new m(this),this.colonyRenderer=new x(this),this.add.text(r.TITLE.X,r.TITLE.Y,r.TITLE.TEXT,{fontSize:r.TITLE.FONT_SIZE,color:r.TITLE.COLOR,fontStyle:"bold"}).setDepth(r.UI_DEPTH),this.add.text(r.INSTRUCTIONS.X,r.INSTRUCTIONS.Y,r.INSTRUCTIONS.TEXT,{fontSize:r.INSTRUCTIONS.FONT_SIZE,color:r.INSTRUCTIONS.COLOR}).setDepth(r.UI_DEPTH),this.add.text(r.LEGEND.X,r.LEGEND.Y,r.LEGEND.TEXT,{fontSize:r.LEGEND.FONT_SIZE,color:r.LEGEND.COLOR}).setDepth(r.UI_DEPTH),this.debugText=this.add.text(r.DEBUG.X,this.scale.height-r.DEBUG.Y_OFFSET_FROM_BOTTOM,"",{fontSize:r.DEBUG.FONT_SIZE,color:r.DEBUG.COLOR,backgroundColor:r.DEBUG.BACKGROUND_COLOR,padding:r.DEBUG.PADDING}).setDepth(r.UI_DEPTH)}update(t,e){const n=e/1e3;this.simulationSystem.update(n),this.colonyRenderer.render(this.world.getColonies());const s=this.world.getAllAnts();this.antRenderer.render(s),this.updateDebugUI(s)}updateDebugUI(t){const e={[o.IDLE]:0,[o.WANDERING]:0,[o.FORAGING]:0,[o.RETURNING]:0};for(const s of t)e[s.state]++;const n=[`Total: ${t.length}`,`Idle: ${e[o.IDLE]}`,`Wandering: ${e[o.WANDERING]}`,`Foraging: ${e[o.FORAGING]}`,`Returning: ${e[o.RETURNING]}`].join(" | ");this.debugText.setText(n)}shutdown(){this.antRenderer.destroy(),this.colonyRenderer.destroy()}}const w={type:E.AUTO,width:R.CANVAS_WIDTH,height:R.CANVAS_HEIGHT,parent:"game-container",backgroundColor:R.BACKGROUND_COLOR,scene:[F],scale:{mode:E.Scale.FIT,autoCenter:E.Scale.CENTER_BOTH}};new E.Game(w);
